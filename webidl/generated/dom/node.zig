// Auto-generated by webidl-codegen
// DO NOT EDIT - changes will be overwritten
//
// This file was generated from the source file with the same name.
// Class definitions have been enhanced with:
//   - Inherited methods from parent classes
//   - Property getters and setters
//   - Optimized field layouts

//! Node interface per WHATWG DOM Standard
//! Spec: https://dom.spec.whatwg.org/#interface-node

const std = @import("std");
const webidl = @import("webidl");
const infra = @import("infra");

const Allocator = std.mem.Allocator;
const EventTarget = @import("event_target").EventTarget;
/// Node WebIDL interface
pub const Node = struct {
    // ========================================================================
    // Node fields
    // ========================================================================
    allocator: Allocator,
    event_target: EventTarget,
    node_type: u16,
    node_name: []const u8,
    parent_node: ?*Node,
    child_nodes: std.ArrayList(*Node),
    owner_document: ?*Document,
    pub const ELEMENT_NODE: u16,
    pub const ATTRIBUTE_NODE: u16,
    pub const TEXT_NODE: u16,
    pub const CDATA_SECTION_NODE: u16,
    pub const ENTITY_REFERENCE_NODE: u16,
    pub const ENTITY_NODE: u16,
    pub const PROCESSING_INSTRUCTION_NODE: u16,
    pub const COMMENT_NODE: u16,
    pub const DOCUMENT_NODE: u16,
    pub const DOCUMENT_TYPE_NODE: u16,
    pub const DOCUMENT_FRAGMENT_NODE: u16,
    pub const NOTATION_NODE: u16,
    pub const DOCUMENT_POSITION_DISCONNECTED: u16,
    pub const DOCUMENT_POSITION_PRECEDING: u16,
    pub const DOCUMENT_POSITION_FOLLOWING: u16,
    pub const DOCUMENT_POSITION_CONTAINS: u16,
    pub const DOCUMENT_POSITION_CONTAINED_BY: u16,
    pub const DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC: u16,

    pub fn init(allocator: Allocator, node_type: u16, node_name: []const u8) !Node {
        return .{
            .allocator = allocator,
            .event_target = try EventTarget.init(allocator),
            .node_type = node_type,
            .node_name = node_name,
            .parent_node = null,
            .child_nodes = std.ArrayList(*Node).init(allocator),
            .owner_document = null,
        };
    }
    pub fn deinit(self: *Node) void {
        self.event_target.deinit();
        self.child_nodes.deinit();
    }
    // ========================================================================
    // Node methods
    // ========================================================================

    /// appendChild(node)
    /// Spec: https://dom.spec.whatwg.org/#dom-node-appendchild
    pub fn call_appendChild(self: *Node, node: *Node) !*Node {
        try self.child_nodes.append(node);
        node.parent_node = self;
        return node;
    }
    /// removeChild(child)
    /// Spec: https://dom.spec.whatwg.org/#dom-node-removechild
    pub fn call_removeChild(self: *Node, child: *Node) !*Node {
        for (self.child_nodes.items, 0..) |node, i| {
            if (node == child) {
                _ = self.child_nodes.orderedRemove(i);
                child.parent_node = null;
                return child;
            }
        }
        return error.NotFoundError;
    }
    /// hasChildNodes()
    /// Spec: https://dom.spec.whatwg.org/#dom-node-haschildnodes
    pub fn call_hasChildNodes(self: *const Node) bool {
        return self.child_nodes.items.len > 0;
    }
    /// cloneNode(deep)
    /// Spec: https://dom.spec.whatwg.org/#dom-node-clonenode
    pub fn call_cloneNode(self: *Node, deep: bool) !*Node {
        _ = deep;
        // Clone the node
        return try Node.init(self.allocator, self.node_type, self.node_name);
    }
    /// normalize()
    /// Spec: https://dom.spec.whatwg.org/#dom-node-normalize
    pub fn call_normalize(self: *Node) void {
        _ = self;
        // Normalize adjacent text nodes
    }
    /// Getters
    pub fn get_nodeType(self: *const Node) u16 {
        return self.node_type;
    }
    pub fn get_nodeName(self: *const Node) []const u8 {
        return self.node_name;
    }
    pub fn get_parentNode(self: *const Node) ?*Node {
        return self.parent_node;
    }
    pub fn get_firstChild(self: *const Node) ?*Node {
        if (self.child_nodes.items.len > 0) {
            return self.child_nodes.items[0];
        }
        return null;
    }
    pub fn get_lastChild(self: *const Node) ?*Node {
        if (self.child_nodes.items.len > 0) {
            return self.child_nodes.items[self.child_nodes.items.len - 1];
        }
        return null;
    }
    pub fn get_ownerDocument(self: *const Node) ?*Document {
        return self.owner_document;
    }
};

